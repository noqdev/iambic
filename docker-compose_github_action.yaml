version: "3"
services:
  iambic_gh_action:
    environment:
      - IAMBIC_CONFIG=arn:aws:secretsmanager:us-west-2:759357822767:secret:dev/iambic-full
      - IAMBIC_CONFIG_ASSUME_ROLE=arn:aws:iam::759357822767:role/IambicSpokeRole
      - AWS_ACCESS_KEY_ID
      - AWS_SECRET_ACCESS_KEY
      - AWS_SESSION_TOKEN
    build:
      context: .
      dockerfile: Dockerfile
    image: iambic
    volumes:
      - ~/.aws:/root/.aws:cached
    entrypoint: ""
    command:
      - "python"
      - "-m"
      - "iambic.lambda.app"
      - "import"
